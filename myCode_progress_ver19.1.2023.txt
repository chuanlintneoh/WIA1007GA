library(dplyr)
library(shiny)
library(shinydashboard)
library(readxl)
library(DT)
library(ggplot2)

data <- read_excel("C:\\Users\\chuan\\OneDrive\\Documents\\WIA1007 DS\\GA1&GA2\\data_obesity_r.xlsx")

ui <- dashboardPage(
  title = "Obesity Risk Assessment",
  skin = "blue",
  dashboardHeader(
    title = "Obesity Risk Assessment",
    titleWidth = 300
  ),
  dashboardSidebar(
    width = 300,
    sidebarMenu(
      menuItem("Find out about me!",tabName = "about", icon = icon("circle-info")),
      menuItem("Predict",tabName = "predict", icon = icon("magnifying-glass-chart")),
      menuItem("Calculate your BMI",tabName = "faq", icon = icon("weight-scale")),
      menuItem("Data",tabName = "data", icon = icon("database")),
      menuItem("Analysis", icon = icon("chart-simple"),
               menuSubItem("Gender",tabName="gender"),
               menuSubItem("Age",tabName="age"),
               menuSubItem("Height",tabName="height"),
               menuSubItem("Weight",tabName="weight"),
               menuSubItem("Family history with overweight",tabName="overweight_history"),
               menuSubItem("Frequent consumption of high caloric food",tabName="high_caloric_food"),
               menuSubItem("Frequency of consumption of vegetables",tabName="vegetables"),
               menuSubItem("Consumption of food between meals",tabName="food_between_meals"),
               menuSubItem("Smoking",tabName="smoking"),
               menuSubItem("Consumption of water daily",tabName="water"),
               menuSubItem("Calories consumption monitoring",tabName="calories_consumption_monitoring"),
               menuSubItem("Physical activity frequency",tabName="physical_activity"),
               menuSubItem("Time using technology devices",tabName="technology_devices"),
               menuSubItem("Consumption of alcohol",tabName="alcohol"),
               menuSubItem("Transportation used",tabName="transportation")
      ),
      menuItem("Reference",tabName = "reference", icon = icon("book")),
      menuItem("Group Details",tabName = "group_details", icon = icon("user-group"))
    )
  ),#dashboardSidebar
  dashboardBody(
    tags$head(tags$style(HTML('
    
                                
                                /* logo */
                                .skin-blue .main-header .logo {
                                background-color: #5C5858;
                                }

                                /* logo when hovered */
                                .skin-blue .main-header .logo:hover {
                                background-color: #5C5858;
                                }

                                /* navbar (rest of the header) */
                                .skin-blue .main-header .navbar {
                                background-color: #5C5858;
                                }        

                                /* main sidebar */
                                .skin-blue .main-sidebar {
                                background-color: #696969;
                                }

                                /* active selected tab in the sidebarmenu */
                                .skin-blue .main-sidebar .sidebar .sidebar-menu .active a{
                                background-color: #8D918D;
                                }

                                /* other links in the sidebarmenu */
                                .skin-blue .main-sidebar .sidebar .sidebar-menu a{
                                background-color: #696969;
                                color: #FFFFFF;
                                }

                                /* other links in the sidebarmenu when hovered */
                                .skin-blue .main-sidebar .sidebar .sidebar-menu a:hover{
                                background-color: #8D918D;
                                }
                                /* toggle button when hovered  */                    
                                .skin-blue .main-header .navbar .sidebar-toggle:hover{
                                background-color: #504A4B;
                                }
                               .content, .container-fluid {background-color: #E5E4E2;}")
                                '))
    ),
    tabItems(
      tabItem(tabName = "about",
              fluidRow(
                box(
                  title = strong("Project Background"),
                  width = 6,
                  h5("Obesity is among the most common health issues worldwide, and it is linked to large numbers of illnesses, threats, and even death. It is a global health problem because it poses a danger to the future. Obesity is a widely known and dynamic major epidemic that has increased rapidly since the 1980s, posing significant health risks in adults, teenagers, and kids. Based on 2019 National Health and Morbidity Survey data (NHMS), 3 out of every 10 persons in Malaysia are overweight, and 2 are obese."),
                  h5("Hence, it is really important for Malaysians to have awareness about this issue and provide them with a tool to have an early understanding about obesity before they risk themselves being obese, when it is already too late. On the basis of it, our group planned to come up with a project which could give an assumption of an individualâ€™s percentage of obesity, according to the following various input variables contributing to it. This project can give users a clear image on their chances of getting obesity, BMI, type of obesity and recommendations.")
                ),
                box(
                  title = strong("Project Objectives"),
                  width = 6,
                  h4("I. To determine the probability of males and females getting obesity."),
                  h4("II. To investigate how each variable in the obesity dataset affects the chances of males and females getting obesity."),
                  h4("III. To evaluate the type of obesity of males and females."),
                  h4("IV. To develop a project model that will predict the possibility that males and females get obesity using machine learning techniques based on the obesity dataset.")
                ),
                box(
                  width = 12,
                  title = strong("Data Glossary"),
                  tableOutput("dictionary")
                )
                
              )
      ),#dashboardBody
      
      tabItem(
        tabName = "predict",
        sidebarLayout(
          sidebarPanel(
            selectInput("gender", "Gender:", c("Male", "Female")),
            sliderInput("age", "Age:", min = 1, max = 100, value = 1),
            selectInput("family_history", "Family history with overweight:", c("No", "Yes")),
            selectInput("high_caloric_food", "Frequent consumption of high caloric food:", c("No", "Yes")),
            selectInput("frequency_of_consumption_of_vegetables", "Frequency of consumption of vegetables:", c("Never", "Sometimes","Always")),
            selectInput("consumption_of_food_between_meals", "Consumption of food between meals:", c("No", "Sometimes","Frequently","Always")),
            selectInput("smoking", "Smoking:", c("No", "Yes")),
            selectInput("calories_consumption_monitoring", "Calories consumption monitoring:", c("No", "Yes")),
            selectInput("consumption_of_water_daily", "Consumption of water daily:", c("Less than 1L", "Between 1 and 2L","More than 2L")),
            selectInput("physical_activity_frequency", "Physical activity frequency:", c("Very less intense","Less intense","Moderate","Intense")),
            selectInput("time_using_technology_devices", "Time using technology devices:", c("Less than average", "Moderate","Very frequent")),
            selectInput("consumption_of_alcohol", "Consumption of alcohol:", c("No", "Sometimes","Frequently","Always")),
            selectInput("transportation_used", "Transportation used:", c("Walking", "Public transportation","Motorbike","Bike","Automobile"))
          ),
          mainPanel(
            width = "70%",
            column(
              width = 6,
            )
          )
        )
      ),
      
      tabItem(tabName = "faq",
              fluidRow(
                box(
                  width = 12,
                  title = strong("Parameters:"),
                  sliderInput("height", "Height (m):", min = 0.00, max = 2.50, value = 0.00, step = 0.01),
                  sliderInput("weight", "Weight (kg):", min = 0.0, max = 200.0, value = 0.0, step = 0.1)
                )
              ),
              fluidRow(
                box(
                  width = 12,
                  title = strong("Results:"),
                  valueBoxOutput("obesityBox",width = 5),
                  valueBoxOutput("categoryBox",width = 7),
                  h4(strong("Recommendations:")),
                  textOutput("recommendationBox")
                )
              ),
              fluidRow(
                width = "100%",
                column(
                  width = 12,
                  box(title = strong("Frequently Asked Questions"),width = NULL,
                      h5("1."),
                      h5("Q: "),
                      h5("A: "),
                      br(),
                      h5("2."),
                      h5("Q: "),
                      h5("A: "),
                      br()
                      )
                )
              )
      ),
      tabItem(tabName = "data",
              fluidRow(
                width = "100%",
                column(
                  width = 12,
                  box(
                    title = strong("Data Source"), width = NULL, solidHeader = TRUE,
                    HTML("<p style='text-align: left;'> Link source | <a href='https://www.kaggle.com/datasets/mandysia/obesity-dataset-cleaned-and-data-sinthetic' target='_blank'>kaggle.com</a></p>"),
                    DT::dataTableOutput("dataset")
                  )
                )
              )
      ),
      tabItem(tabName = "gender",
              fluidRow(
                width = "100%",
                column(
                  width = 8,
                  tabBox(
                    title = strong("Gender"),
                    side = "right",
                    width = "100%",
                    tabPanel(
                      "Table",
                      tableOutput("gendertable")
                    ),
                    tabPanel(
                      "Chart",
                      plotOutput("genderbarchart")
                    )
                  )
                ),
                column(
                  width = 4,
                  box(
                    title = strong("Description"),
                    width = "100%",
                    "Referring to the bar chart, 482 out of 1043 females are obese, with a percentage of 46.21%. On the other hand, in the male gender group, 492 out of 1068 males are diagnosed with obesity, with a percentage of 46.07%. The percentage of obesity in the female gender group is slightly higher than male. In conclusion, females are likely to be obese compared to males."
                  )
                )
              )
      ),
      tabItem(tabName = "age", 
              fluidRow(
                width = "100%",
                column(
                  width = 12,
                  tabBox(
                    title = strong("Age"),
                    side = "right",
                    width = "100%",
                    tabPanel(
                      "Graph",
                      plotOutput("agegraph")
                    )
                  )
                ),
                column(
                  width = 12,
                  box(
                    title = strong("Description"),
                    width = "100%",
                    "Referring to the graph, it is observable that the frequency of individuals getting obesity is highest at their mid-twenties (age 26). Besides that, it is also clear that the frequency of obesity is dominant when individuals age from their adolescent phase to their adult phase but starts decreasing when approaching their senior years.  It is most distinguishable when individuals age from their teenage years and reach their early thirties is where the frequency of getting obesity is the highest among other weight groups. Overall, the risk of obesity increases with increasing age(14 - 40) but begins to decline when approaching senior years(41 - 65)."
                  )
                )
              )
      ),
      tabItem(tabName = "height",
              fluidRow(
                width = "100%",
                column(
                  width = 12,
                  tabBox(
                    title = strong("Height"),
                    side = "right",
                    width = "100%",
                    tabPanel(
                      "Graph",
                      plotOutput("heightgraph")
                    )
                  )
                ),
                column(
                  width = 12,
                  box(
                    title = strong("Description"),
                    width = "100%",
                    "Referring to the graph, it is observed that the frequency of individuals getting obesity is highest at the range 1.74 metres to 1.79 metres and followed by 1.61 metres to 1.65 metres. This is most likely because the average height of the population is distributed in between 1.74 metres and 1.79 metres. In contrast, taking the amount of food intake as a constant, the obesity trend for height ranged between 1.61 metres and 1.65 metres can be assumed to be caused by shorter individuals which require fewer calories than taller individuals, just by the nature of the fact that they are smaller. Therefore, we can conclude that decreasing height will increase the risk of obesity. This is also justified by the formula of calculating BMI (weight (in kg)/ height^2 (in m^2)) at which height^2 is inversely proportional to BMI."
                  )
                )
              )
      ),
      tabItem(tabName = "weight",
              fluidRow(
                width = "100%",
                column(
                  width = 12,
                  tabBox(
                    title = strong("Weight"),
                    side = "right",
                    width = "100%",
                    tabPanel(
                      "Graph",
                      plotOutput("weightgraph")
                    )
                  )
                ),
                column(
                  width = 12,
                  box(
                    title = strong("Description"),
                    width = "100%",
                    "Referring to the graph, From the graph above, we can observe that starting from lower weight, the frequency of underweight is the highest compared to the 3 other types of obesity. When the weight increases, the classification of obesity with higher frequency changes to normal and then followed by overweight. At the weight of higher range, there is only left with obesity which other 3 types of obesity have 0 frequency. This justified the formula of calculating BMI (weight (in kg)/ height^2 (in m^2)) at which weight is directly proportional to BMI. As BMI increases, the type of obesity changes from underweight, normal to overweight and lastly obesity."
                  )
                )
              )
      ),
      tabItem(tabName = "overweight_history",
              fluidRow(
                width = "100%",
                column(
                  width = 8,
                  tabBox(
                    title = strong("Family History with Overweight"),
                    side = "right",
                    width = "100%",
                    tabPanel(
                      "Table",
                      tableOutput("historytable")
                    ),
                    tabPanel(
                      "Chart",
                      plotOutput("historybarchart")
                    )
                  )
                ),
                column(
                  width = 4,
                  box(
                    title = strong("Description"),
                    width = "100%",
                    "Referring to the bar chart, we can observe that individuals without family history with overweight have a lower chance of having obesity which is 2.07% and also a lower chance of being overweight with 24.16% compared to being normal and underweight which are 35.58% and 38.18% respectively. However, it is shown that individuals with a family history of overweight have a higher probability of being obese and overweight which are 55.98% and 27.40% respectively compared to the percentage of being normal and underweight which in fact are 9.44% and 7.18% respectively. To sum up, individuals with a family history of being overweight are more likely to have obesity."
                  )
                )
              )
      ),
      tabItem(tabName = "high_caloric_food",
              fluidRow(
                width = "100%",
                column(
                  width = 8,
                  tabBox(
                    title = strong("Frequent Consumption of High Caloric Food"),
                    side = "right",
                    width = "100%",
                    tabPanel(
                      "Table",
                      tableOutput("calorictable")
                    ),
                    tabPanel(
                      "Chart",
                      plotOutput("highcaloricfoodbarchart")
                    )
                  )
                ),
                column(
                  width = 4,
                  box(
                    title = strong("Description"),
                    width = "100%",
                    "Referring to the bar chart, 76.37% of individuals who frequently consume high caloric foods develop obesity or are overweight, only 11.9% of them are at normal weight and 11.74% of them are underweight. However, only 46.94% of individuals who do not frequently consume high caloric foods become obese or overweight, 31.84% of them are at normal weight and 21.22% of them are underweight. Thus, it is proven that individuals who have frequent consumption of high caloric food are more likely to get obesity as compared to those who do not consume high caloric food frequently."
                  )
                )
              )
      ),
      tabItem(tabName = "vegetables",
              fluidRow(
                width = "100%",
                column(
                  width = 8,
                  tabBox(
                    title = strong("Frequency of Consumption of Vegetables"),
                    side = "right",
                    width = "100%",
                    tabPanel(
                      "Table",
                      tableOutput("vegetable")
                    ),
                    tabPanel(
                      "Chart",
                      plotOutput("vegetablesbarchart")
                    )
                  )
                ),
                column(
                  width = 4,
                  box(
                    title = strong("Description"),
                    width = "100%",
                    "Referring to the bar chart, individuals who always eat vegetables, a total of 72.09% become obese or overweight. Of the individuals who sometimes consume vegetables, a total of 75.22% become obese or overweight. 58.82% of individuals who never eat vegetables develop obesity or are overweight. Since there are too few individuals who never ate vegetables(4.83%) as compared to those who always or sometimes did, this statistic was not taken into comparison. From the statistics calculated, the percentage of individuals who consume vegetables sometimes to suffer from obesity and overweight is slightly higher than that of those who always consume vegetables."
                  )
                )
              )
      ),
      tabItem(tabName = "food_between_meals",
              fluidRow(
                width = "100%",
                column(
                  width = 8,
                  tabBox(
                    title = strong("Consumption of Food Between Meals"),
                    side = "right",
                    width = "100%",
                    tabPanel(
                      "Table",
                      tableOutput("COFtable")
                    ),
                    tabPanel(
                      "Chart",
                      plotOutput("foodbarchart")
                    )
                  )
                ),
                column(
                  width = 4,
                  box(
                    title = strong("Description"),
                    width = "100%",
                    "Referring to the bar chart, it can be seen that among the individuals who do not consume food between meals more than half of them which is 3.92% and 70.59% belong to the obesity and overweight group respectively. Just as sometimes snacking between meals, the majority which is 54.16% and 27.88% of the individuals are obesity and overweight. On the contrary, only 15.09% and 15.09% of individuals who always snack between meals are obese and overweight as well as only 3.31% and 12.40% of individuals who frequently consume food outside main meals are diagnosed with obesity and overweight. Therefore, individuals who always consume or frequently consume food between meals are most likely normal weight and underweight, it has proven that increased consumption of food between meals will result in a reduction in weight."
                  )
                )
              )
      ),
      tabItem(tabName = "smoking",
              fluidRow(
                width = "100%",
                column(
                  width = 8,
                  tabBox(
                    title = strong("Smoking"),
                    side = "right",
                    width = "100%",
                    tabPanel(
                      "Table",
                      tableOutput("smoketable")
                    ),
                    tabPanel(
                      "Chart",
                      plotOutput("smokingbarchart")
                    )
                  )
                ),
                column(
                  width = 4,
                  box(
                    title = strong("Description"),
                    width = "100%",
                    "Referring to the bar chart, it is shown that for non-smokers, the risk of getting obesity or being overweight which is 73.05%  is much higher than the percentage of getting obesity or being overweight in current-smokers which is 68.18%. As for the percentage of normal or underweight in non-smokers is 26.95% and as for the percentage of normal or underweight for current-smokers is 31.82%. This shows that non-smokers have a higher chance of being obese or overweight compared to current-smokers."
                  )
                )
              )
      ),
      tabItem(tabName = "water",
              fluidRow(
                width = "100%",
                column(
                  width = 8,
                  tabBox(
                    title = strong("Consumption of Water Daily"),
                    side = "right",
                    width = "100%",
                    tabPanel(
                      "Table",
                      tableOutput("watertable")
                    ),
                    tabPanel(
                      "Chart",
                      plotOutput("waterbarchart")
                    )
                  )
                ),
                column(
                  width = 4,
                  box(
                    title = strong("Description"),
                    width = "100%",
                    "Referring to the bar chart, 64.54% of individuals from the category of daily water consumption of less than 1L are overweight or obese. Secondly, for the between 1 and 2L category, the percentage of overweight or obesity is 71.82% and subsequently, 83% for daily water consumption of more than 2L. We can see that when the daily water consumption increases, the percentage of overweight or obesity individuals increases. Therefore, we can conclude that based on this particular dataset, drinking more water will contribute to a higher chance of getting obesity."
                  )
                )
              )
      ),
      tabItem(tabName = "calories_consumption_monitoring",
              fluidRow(
                width = "100%",
                column(
                  width = 8,
                  tabBox(
                    title = strong("Calories Consumption Monitoring"),
                    side = "right",
                    width = "100%",
                    tabPanel(
                      "Table",
                      tableOutput("monitortable")
                    ),
                    tabPanel(
                      "Chart",
                      plotOutput("caloriesbarchart")
                    )
                  )
                ),
                column(
                  width = 4,
                  box(
                    title = strong("Description"),
                    width = "100%",
                    "Referring to the bar chart, 48.19% and 26.4% of individuals who do not monitor their intake of calories are obese and overweight. However, only 3.13% and 35.42% of individuals who monitor their intake of calories are obese and overweight, most of them are normal or underweight. In this manner, we can conclude that the risk of obesity can be reduced effectively by monitoring our consumption of calories."
                  )
                )
              )
      ),
      tabItem(tabName = "physical_activity",
              fluidRow(
                width = "100%",
                column(
                  width = 8,
                  tabBox(
                    title = strong("Physical Activity Frequency"),
                    side = "right",
                    width = "100%",
                    tabPanel(
                      "Table",
                      tableOutput("physicaltable")
                    ),
                    tabPanel(
                      "Chart",
                      plotOutput("physicalbarchart")
                    )
                  )
                ),
                column(
                  width = 4,
                  box(
                    title = strong("Description"),
                    width = "100%",
                    "Referring to the bar chart, 78.09% and 77.64% of individuals from the category of less intense and very less intense physical activity respectively are overweight or obese. For overweight individuals, only 25.44% of them have moderate or intense physical activity. It is even worse for obesity ones at which 23.72% carry out physical activity regularly. This means that those who are overweight or obese do not exercise oftenly. Hence, it is clearly shown that increasing the physical activity frequency helps to decrease the chance of one being overweight or obese."
                  )
                )
              )
      ),
      tabItem(tabName = "technology_devices",
              fluidRow(
                width = "100%",
                column(
                  width = 8,
                  tabBox(
                    title = strong("Time using Technology Devices"),
                    side = "right",
                    width = "100%",
                    tabPanel(
                      "Table",
                      tableOutput("techtable")
                    ),
                    tabPanel(
                      "Chart",
                      plotOutput("technologybarchart")
                    )
                  )
                ),
                column(
                  width = 4,
                  box(
                    title = strong("Description"),
                    width = "100%",
                    "The bar chart demonstrates that 47.48% and 28.78% of individuals who spend less than average time on technology devices are diagnosed with obesity and overweight. There are 48.31% and 23.93% of individuals who uses technology devices moderately are obese and overweight while 32.79% and 29.92% of those who admitted using technology devices frequently are obese and overweight. Based on the statistics, the greater the time using technology devices, the lower the risk of obesity."
                  )
                )
              )
      ),
      tabItem(tabName = "alcohol",
              fluidRow(
                width = "100%",
                column(
                  width = 8,
                  tabBox(
                    title = strong("Consumption of Alcohol"),
                    side = "right",
                    width = "100%",
                    tabPanel(
                      "Table",
                      tableOutput("alcoholtable")
                    ),
                    tabPanel(
                      "Chart",
                      plotOutput("alcoholbarchart")
                    )
                  )
                ),
                column(
                  width = 4,
                  box(
                    title = strong("Description"),
                    width = "100%",
                    "Referring to the bar chart, 64.63% of the individuals who do not consume alcohol are obese or overweight, 76.80% of individuals who sometimes consume alcohol are obese or overweight, only 22.5% of the individuals who frequently and always consume alcohol are obese or overweight. Therefore, it is clearly shown that the chance of getting overweight or obese decreases when the consumption of alcohol of an individual increases from no to sometimes, and increases when one consumes alcohol intensely."
                  )
                )
              )
      ),
      tabItem(tabName = "transportation",
              fluidRow(
                width = "100%",
                column(
                  width = 8,
                  tabBox(
                    title = strong("Transportation Used"),
                    side = "right",
                    width = "100%",
                    tabPanel(
                      "Table",
                      tableOutput("transtable")
                    ),
                    tabPanel(
                      "Chart",
                      plotOutput("transportationbarchart")
                    )
                  )
                ),
                column(
                  width = 4,
                  box(
                    title = strong("Description"),
                    width = "100%",
                    "Referring to the bar chart, 45.30% and 34.14% of automobile users are diagnosed with obesity and overweight. A similar pattern is repeated for public transportation, 48.10% and 24.75% of the individuals are obese and overweight. On the other hand, individuals who use bikes, motorbikes and walking to travel are less likely to have obesity. Only 14.29% and 28.57% of individuals who choose to bike for transport are obese and overweight while only 27.27% and 18.18% of individuals using motorbikes are diagnosed with obesity and overweight. Walking is the most effective mode of transportation to reduce obesity risk. 57.14% and 10.71% of individuals who walk have normal weight or are underweight while only 5.36% and 26.79% are obese and overweight. To sum up, transport by automobile, public transportation, motorbike, bike and walking have decreasing likelihood of developing obesity."
                  )
                )
              )
      ),
      tabItem(tabName = "reference",
              fluidRow(
                width = "100%",
                column(
                  width = 12,
                  box(
                    title = strong("References"),
                    width = "100%",
                    paste("No.1 | R Pie Charts. R Graphics - Pie . Retrieved (January 11,2023), from"),
                    HTML("<p style='text-align: left;'><a href='https://www.w3schools.com/r/r_graph_pie.asp' target='_blank'>https://www.w3schools.com/r/r_graph_pie.asp</a></p>"),
                    br(),
                    paste("No.2 | Welcome to shiny. Shiny. (n.d.). Retrieved (January 11, 2023), from"),
                    HTML("<p style='text-align: left;'><a href='https://shiny.rstudio.com/tutorial/written-tutorial/lesson1/' target='_blank'>https://shiny.rstudio.com/tutorial/written-tutorial/lesson1/</a></p>"),
                    br(),
                    paste("No.3 | Shiny Dashboard Structure. Retrieved (January 13,2023), from"),
                    HTML("<p style='text-align: left;'><a href='https://rstudio.github.io/shinydashboard/structure.html#dynamic-content' target='_blank'>https://rstudio.github.io/shinydashboard/structure.html#dynamic-content</a></p>"),
                    br(),
                    paste("No.4 | Customizing dashboard appearance. Retrieved (January 13,2023), from"),
                    HTML("<p style='text-align: left;'><a href='https://rstudio.github.io/shinydashboard/appearance.html#logout-panel' target='_blank'>https://rstudio.github.io/shinydashboard/appearance.html#logout-panel</a></p>"),
                    br(),
                    paste("No.5 | Shiny dashboard behavior. (n.d.). Retrieved January 16, 2023, from"),
                    HTML("<p style='text-align: left;'><a href='https://rstudio.github.io/shinydashboard/behavior.html#shinydashboard-specific-components' target='_blank'>https://rstudio.github.io/shinydashboard/behavior.html#shinydashboard-specific-components</a></p>"),
                    br(),
                    paste("No.6 | Gallery. Shiny dashboard behavior (n.d.). Retrieved (January 16, 2023), from"),
                    HTML("<p style='text-align: left;'><a href='https://shiny.rstudio.com/gallery/' target='_blank'>https://shiny.rstudio.com/gallery/</a></p>"),
                    br(),
                    paste("No.7 | Vedha Viyash (1965, September 1). How to change the background color of The shiny dashboard body. Stack Overflow. Retrieved (January 16, 2023), from"),
                    HTML("<p style='text-align: left;'><a href='https://stackoverflow.com/questions/52198452/how-to-change-the-background-color-of-the-shiny-dashboard-body#:~:text=The%20background%20color%20is%20always,Here%20is%20a%20reproducible%20application.&text=Possible%20duplicate%20of%20How%20to%20change%20color%20in%20shiny%20dashboard%3F&text=Please%20see%20library(fresh)' target='_blank'>https://stackoverflow.com/questions/52198452/how-to-change-the-background-color-of-the-shiny-dashboard-body#:~:text=The%20background%20color%20is%20always,Here%20is%20a%20reproducible%20application.&text=Possible%20duplicate%20of%20How%20to%20change%20color%20in%20shiny%20dashboard%3F&text=Please%20see%20library(fresh)</a></p>"),
                    br(),
                    paste("No.8 | Sharp icons. Font Awesome. (n.d.). Retrieved (January 16, 2023), from"),
                    HTML("<p style='text-align: left;'><a href='https://fontawesome.com/search?o=r&f=sharp' target='_blank'>https://fontawesome.com/search?o=r&f=sharp</a></p>"),
                    br(),
                    paste("No.9 | Random Forest approach in R programming. GeeksforGeeks. (2020, June 5). Retrieved (January 17, 2023), from"),
                    HTML("<p style='text-align: left;'><a href='https://www.geeksforgeeks.org/random-forest-approach-in-r-programming/' target='_blank'>https://www.geeksforgeeks.org/random-forest-approach-in-r-programming/</a></p>"),
                    br(),
                    paste("No.10 | Tabora, V. (2019, September 25). SVM classification algorithms in R. Medium. Retrieved (January 17, 2023), from"),
                    HTML("<p style='text-align: left;'><a href='https://medium.com/0xcode/svm-classification-algorithms-in-r-ced0ee73821' target='_blank'>https://medium.com/0xcode/svm-classification-algorithms-in-r-ced0ee73821</a></p>"),
                    br(),
                    paste("No.11 | Datasciencebeginners. (2020, May 27). Multinomial logistic regression with R: R-bloggers. R. Retrieved (January 17, 2023), from"),
                    HTML("<p style='text-align: left;'><a href='https://www.r-bloggers.com/2020/05/multinomial-logistic-regression-with-r/' target='_blank'>https://www.r-bloggers.com/2020/05/multinomial-logistic-regression-with-r/</a></p>"),
                    br(),
                    paste("No.12 | How to apply gradient boosting for classification in R -. ProjectPro. (n.d.). Retrieved January 17, 2023, from"),
                    HTML("<p style='text-align: left;'><a href='https://www.projectpro.io/recipes/apply-gradient-boosting-for-classification-r' target='_blank'>https://www.projectpro.io/recipes/apply-gradient-boosting-for-classification-r</a></p>"),
                    br(),
                    paste("No.13 | HTML color codes and names. Computer Hope. (2022, October 18). Retrieved (January 17, 2023), from"),
                    HTML("<p style='text-align: left;'><a href='https://www.computerhope.com/htmcolor.htm#:~:text=HTML%20color%20codes%20are%20hexadecimal,on%20a%2024%2Dbit%20display' target='_blank'>https://www.computerhope.com/htmcolor.htm#:~:text=HTML%20color%20codes%20are%20hexadecimal,on%20a%2024%2Dbit%20display</a></p>"),
                    br()
                  ),
                )
              )
      ),
      tabItem(tabName = "group_details",
              fluidRow(
                box(
                  height = "280px",
                  width = 9,
                  h1(strong("Group Details")),
                  plotOutput("groupdetailsHeader")
                )
              ),
              fluidRow(
                box(
                  width = 4,
                  height = "625px",
                  h2(strong("Group Leader")),
                  h3("CHEE YAO SERN SHAWN"),
                  h3("22004874")
                  
                ),
                box(
                  h2(strong("Group Members")),
                  width = 5,
                  height = "80px"
                ),
                box(
                  width = 4,
                  height = "250px",
                  h3("TNEOH CHUAN LIN"),
                  h3("22004808")
                ),
                box(
                  width = 4,
                  height = "250px",
                  h3("PANG SZE WEN"),
                  h3("22004873")
                ),
                box(
                  width = 4,
                  height = "250px",
                  h3("VINNIE TIANG WEN YING"),
                  h3("22004876")
                ),
                box(
                  width = 4,
                  height = "250px",
                  h3("WINNIE CHENG JING WEN"),
                  h3("22057027")
                )
              ),
              fluidRow(
                width = "100%",
                column(
                  width = 12,
                  HTML("<p style='text-align: center;'>Code Github Link @ 2023 | <a href='https://github.com/chuanlintneoh/WIA1007GA' target='_blank'>github.com</a></p>")
                )
              )
      )
    )#tabitems
  )#dashboardBody
)#dashboardPage




server <- function(input, output){
  bmi <- reactive({as.numeric(input$weight)/(as.numeric(input$height)^2)})
  output$bmi <- renderText({
    bmi()
  })
  output$obesityBox <- renderValueBox({
    valueBox(
      paste0(round((bmi()),2)),"BMI",icon = icon("fire"),color = "purple"
    )
  })
  category <- reactive({
    if (as.numeric(input$height) == 0){
      "Invalid"
    }else if (bmi() < 18.5){
      "Underweight"
    }else if (bmi() < 25){
      "Normal"
    }else if (bmi() < 30){
      "Overweight"
    }else{
      "Obesity"
    }
  })
  output$categoryBox <- renderValueBox({
    if (category() == "Invalid"){
      valueBox(
        paste0(category()),"Category",icon=icon("list"),color = "black"
      )
    }else if (category() == "Underweight"){
      valueBox(
        paste0(category()),"Category",icon=icon("list"),color = "yellow"
      )
    }else if (category() == "Normal"){
      valueBox(
        paste0(category()),"Category",icon=icon("list"),color = "green"
      )
    }else if (category() == "Overweight"){
      valueBox(
        paste0(category()),"Category",icon=icon("list"),color = "orange"
      )
    }else {
      valueBox(
        paste0(category()),"Category",icon=icon("list"),color = "red"
      )
    }
  })
  output$recommendationBox <- renderText({
    if (category() == "Invalid"){
      paste("Sorry, the height and weight you entered appear to be incorrect or invalid. We are unable to calculate your BMI with the height and weight provided. Please ensure that the input values you entered are accurate and try again.")
    }else if (category() == "Underweight"){
      paste("Based on the information you have provided, it appears that you are currently underweight. Maintaining a healthy weight is important for overall well-being and can help prevent various health issues. It is crucial to focus on increasing calorie intake in a healthy and balanced manner. This can be achieved by incorporating nutrient-dense foods such as lean proteins, healthy fats, and whole grains into your diet. These foods not only provide essential nutrients but also help to keep you feeling full and satisfied. Additionally, it may be helpful to consult with a dietitian or nutritionist to create a personalized meal plan that takes into account your dietary needs and goals. They can also provide guidance on safe and effective ways to increase your calorie intake.")
    }else if (category() == "Normal"){
      paste("Great job! Based on the information you have provided, it appears that your Body Mass Index (BMI) is in a healthy range. This is a positive indication of your overall health and well-being. However, it is important to maintain a healthy diet and regular exercise routine to prevent weight gain and maintain overall health. Eating a balanced diet with a variety of fruits, vegetables, whole grains, lean proteins, and healthy fats is essential for providing your body with the essential nutrients it needs to function properly. Additionally, engaging in regular physical activity can help to increase muscle mass and maintain a healthy weight. This can include activities such as brisk walking, jogging, cycling, swimming, or any other form of exercise that you enjoy and that is appropriate for your fitness level. By making healthy choices and staying active, you can continue to take care of your health and improve your overall well-being.")
    }else if (category() == "Overweight"){
      paste("Whoops! Careful, based on the information you have provided, it appears that you are currently overweight and very close to the border line of obesity. Being overweight or obese can increase the risk of various health issues such as heart disease, diabetes, and high blood pressure. Therefore, it's important to take action to lose weight in a healthy manner. This can be achieved by reducing calorie intake and increasing physical activity. A diet that is low in processed foods and high in nutrient-dense options such as fruits, vegetables, whole grains, and lean proteins is recommended. This type of diet can help you to feel full and satisfied while also providing your body with essential nutrients. Additionally, setting realistic weight loss goals and tracking progress can help to maintain motivation and monitor progress over time. Consult with a dietitian or nutritionist to create a personalized meal plan and an exercise routine that is appropriate for your fitness level.")
    }else {
      paste("Oh no! Based on the information you have provided, it appears that you are currently obese. Obesity is a serious health issue that can increase the risk of various chronic diseases such as heart disease, diabetes, and high blood pressure. Therefore, it's important to take action to lose weight and improve overall health. Long-term weight loss and lifestyle changes are key in achieving this. This may include working with a dietitian or nutritionist to create a personalized meal plan, engaging in regular physical activity, and making changes to overall lifestyle habits. This can include things such as getting enough sleep, reducing stress, and avoiding smoking and excessive alcohol consumption. It may also be helpful to seek support from a therapist or counselor to address any emotional or psychological factors that may be contributing to weight gain. With the right approach and a supportive team, it's possible to achieve a healthier weight and improve overall well-being.")
    }
  })
  output$dataset <- DT::renderDataTable({
    datatable(data, options = list(pageLength = 10, scrollX = TRUE))
  })
  output$dictionary <- renderTable({
    data.frame(
      "No." = c(1:17),
      Variable = c("Gender","Age","Height.m.","Weight.kg.","Family.history.with.overweight","Frequent.consumption.of.high.caloric.food","Frequency.of.consumption.of.vegetables","Consumption.of.food.between.meals","Smoking","Consumption.of.water.daily","Calories.consumption.monitoring","Physical.activity.frequency","Time.using.technology.devices","Consumption.of.alcohol","Transportation.used","Type.of.obesity","BMI"),
      Description = c(
        "Respondent's gender.",
        "Respondent's age.",
        "Respondent's height.",
        "Respondent's weight.",
        "Has a family member of the respondent suffered or suffers from overweight?",
        "Has the respondent consume high caloric food frequently?",
        "Respondent's frequency of consumption of vegetables.",
        "Respondent's frequency of consuming food between meals.",
        "Has the respondent smoke?",
        "Respondent's daily consumption of water.",
        "Has the respondent monitor his/her consumption of calories?",
        "Respondent's frequency of physical activities.",
        "Respondent's time spent on technology devices.",
        "Respondent's frequency of consuming alcohol.",
        "Transportation used by respondent.",
        "Respondent's category of BMI.",
        "Respondent's Body Mass Index (BMI = Weight.kg./(Height.m.)^2)."
      ),
      "Parameter Unit" = c(
        "Male | Female",
        "Years",
        "Metres",
        "Kilogrammes",
        "Yes | No",
        "Yes | No",
        "Never | Sometimes | Always",
        "No | Sometimes | Frequently | Always",
        "Yes | No",
        "Less than 1L | Between 1 and 2L | More than 2L",
        "Yes | No",
        "Very less intense | Less intense | Moderate | Intense",
        "Less than average | Moderate | Very frequent",
        "No | Sometimes | Frequently | Always",
        "Walking | Public transportation | Motorbike | Bike | Automobile",
        "Underweight | Normal weight | Overweight | Obesity",
        "kg/m^2"
      )
    )
  })
  #gender
  gender_table <- table(data$Type.of.obesity, data$Gender)
  names(gender_table)[1] <- "Type.of.obesity"
  names(gender_table)[2] <- "Gender"
  output$gendertable <- renderTable({
    print(gender_table)
  })
  output$genderbarchart <- renderPlot({
    gender_barchart <- barplot(gender_table,ylim=c(0,600), xlab = "Gender", ylab = "Frequency", col = c("blue", "red","green","yellow"), legend.text = rownames(gender_table), beside = TRUE)
  })
  #age
  age_table <- table(data$Type.of.obesity,data$Age)
  age_data <- as.data.frame(age_table)
  names(age_data)[1] <- "Type.of.obesity"
  names(age_data)[2] <- "Age"
  output$agegraph <- renderPlot({
    age_graph <- ggplot(data=age_data, aes(x=Age,y=Freq,group=Type.of.obesity, color=Type.of.obesity)) + geom_line()
    print(age_graph)
  })
  #height
  height_table <- table(data$Type.of.obesity,data$Height.m.)
  height_data <- as.data.frame(height_table)
  names(height_data)[1] <- "Type.of.obesity"
  names(height_data)[2] <- "Height"
  output$heightgraph <- renderPlot({
    height_graph <- ggplot(data=height_data, aes(x=Height,y=Freq, group=Type.of.obesity, color=Type.of.obesity)) + geom_line()
    print(height_graph + theme(axis.text.x = element_text(angle=45)))
  })
  #weight
  weight_table <- table(data$Type.of.obesity,data$Weight.kg.)
  weight_data <- as.data.frame(weight_table)
  names(weight_data)[1] <- "Type.of.obesity"
  names(weight_data)[2] <- "Weight"
  output$weightgraph <- renderPlot({
    weight_graph <- ggplot(data=weight_data, aes(x=Weight,y=Freq, group=Type.of.obesity, color=Type.of.obesity)) + geom_line()
    print(weight_graph + theme(axis.text.x = element_text(angle=90)))
  })
  #family history with overweight
  history_table <-table(data$Type.of.obesity,data$Family.history.with.overweight)
  output$historytable <- renderTable({
    print(history_table)
  })
  output$historybarchart <- renderPlot({
    history_barchart <- barplot(history_table, xlab="Family history with overweight", ylab="Frequency",col=c("blue","red","green","yellow"),legend.text=rownames(history_table), beside=TRUE)
  })
  #frequent consumption of high caloric food
  caloric_table <- table(data$Type.of.obesity,data$Frequent.consumption.of.high.caloric.food)
  output$calorictable <- renderTable({
    print(caloric_table)
  })
  output$highcaloricfoodbarchart <- renderPlot({
    caloric_barchart <- barplot(caloric_table, xlab = "Frequent consumption of high caloric food", ylab = "Frequency", col = c("blue", "red","green","yellow"), legend.text = rownames(caloric_table), beside = TRUE)
  })
  #frequency of consumption of vegetables
  vege_table <- table(data$Type.of.obesity,data$Frequency.of.consumption.of.vegetables)
  output$vegetable <- renderTable({
    print(vege_table)
  })
  output$vegetablesbarchart <- renderPlot({
    vege_barchart <- barplot(vege_table, ylim = c(0,600),xlab = "Frequency of consumption of vegetables", ylab = "Frequency", col = c("blue", "red","green","yellow"), legend.text = rownames(vege_table), beside = TRUE)
  })
  #consumption of food between meals
  COF_table <- table(data$Type.of.obesity, data$Consumption.of.food.between.meals)
  output$COFtable <- renderTable({
    print(COF_table)
  })
  output$foodbarchart <- renderPlot({
    COF_barchart <- barplot(COF_table,ylim=c(0,1400), xlab = "Consumption of food between meals", ylab = "Frequency", col = c("blue", "red","green","yellow"), legend.text = rownames(COF_table), beside = TRUE)
  })
  #smoking
  smoke_table <- table(data$Type.of.obesity, data$Smoking)
  output$smoketable <- renderTable({
    print(smoke_table)
  })
  output$smokingbarchart <- renderPlot ({
    smoke_barchart <- barplot(smoke_table, ylim =c(0,1000),xlab = "Smoking", ylab = "Frequency", col = c("blue","red","green","yellow"), legend.text = rownames(smoke_table),beside = TRUE)
  })
  #consumption of water daily
  water_table <- table(data$Type.of.obesity,data$Consumption.of.water.daily)
  output$watertable <- renderTable({
    print(water_table)
  })
  output$waterbarchart <- renderPlot ({
    water_barchart <- barplot(water_table,ylim=c(0,500), xlab = "Consumption of water daily", ylab = "Frequency", col = c("blue", "red","green","yellow"), legend.text = rownames(water_table), beside = TRUE)
  })
  #calories consumption monitoring
  monitor_table <- table(data$Type.of.obesity,data$Calories.consumption.monitoring)
  output$monitortable <- renderTable({
    print(monitor_table)
  })
  output$caloriesbarchart <- renderPlot({
    monitor_barchart <- barplot(monitor_table, ylim = c(0,1000),xlab="Calories consumption monitoring", ylab = "Frequency",col = c("blue","red","green","yellow"), legend.text = rownames(monitor_table), beside = TRUE)
  })
  #physical activity frequency
  physical_table <- table(data$Type.of.obesity,data$Physical.activity.frequency)
  output$physicaltable <- renderTable({
    print(physical_table)
  })
  output$physicalbarchart <- renderPlot({
    physical_barchart <- barplot(physical_table, ylim = c(0,600),xlab = "Physical activity frequency", ylab="Frequency", col =c("blue","red","green","yellow"), legend.text = rownames(physical_table), beside = TRUE)
  })
  #time using technology devices
  tech_table <- table(data$Type.of.obesity,data$Time.using.technology.devices)
  output$techtable <- renderTable({
    print(tech_table)
  })
  output$technologybarchart <- renderPlot({
    tech_barchart <- barplot(tech_table, ylim = c(0,500),xlab="Time using technology devices", ylab="Frequency", col = c("blue","red","green","yellow"), legend.text = rownames(tech_table),beside = TRUE)
  })
  #consumption of alcohol
  alcohol_table <- table(data$Type.of.obesity,data$Consumption.of.alcohol)
  output$alcoholtable <- renderTable({
    print(alcohol_table)
  })
  output$alcoholbarchart <- renderPlot ({
    alcohol_barchart <- barplot(alcohol_table, ylim = c(0,1100),xlab="Consumption of alcohol", ylab="Frequency", col = c("blue","red","green","yellow"), legend.text = rownames(alcohol_table),beside = TRUE)
  })
  #transportation used
  trans_table <- table(data$Type.of.obesity,data$Transportation.used)
  output$transtable <- renderTable({
    print(trans_table)
  })
  output$transportationbarchart <- renderPlot({
    trans_barchart <- barplot(trans_table, ylim = c(0,800),xlab="Transportation used", ylab="Frequency", col=c("blue","red","green","yellow"), legend.text = rownames(trans_table),beside = TRUE)
  })
  output$groupdetailsHeader <- renderImage({
    list(src = "C:\\Users\\chuan\\OneDrive\\Documents\\WIA1007 DS\\GA1&GA2\\ui images\\WIA1007 INTRODUCTION TO DATA SCIENCE.png",width="70%")
  }, deleteFile = F)
}
shinyApp(ui = ui, server = server)